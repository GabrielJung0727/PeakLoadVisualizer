<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Peak FTP Observatory</title>
    <link rel="stylesheet" href="/styles.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js" defer></script>
    <script type="module" src="/assets/main.js" defer></script>
  </head>
  <body>
    <nav class="topbar">
      <div class="topbar__brand">
        <span class="dot"></span>
        <strong>Peak FTP Observatory</strong>
      </div>
      <div class="topbar__links">
        <a id="nav-dashboard" href="#dashboard">대시보드</a>
        <a id="nav-identity" href="#identity">닉네임 설정</a>
        <a id="nav-insights" href="#insights">업로드 통계</a>
        <a id="nav-leaderboard" href="#leaderboard">리더보드</a>
      </div>
      <div class="topbar__langs">
        <button class="lang-btn active" data-lang="ko">한국어</button>
        <button class="lang-btn" data-lang="en">English</button>
      </div>
    </nav>
    <header class="hero">
      <div class="hero__text">
        <p class="eyebrow">
          금요일 FTP 업로드 관제
          <span class="help-wrap"><button class="help" data-help-key="windows">?</button><span class="help-tooltip"></span></span>
          · 실습 트래픽
          <span class="help-wrap"><button class="help" data-help-key="vmware">?</button><span class="help-tooltip"></span></span>
          · Peak 탐지
          <span class="help-wrap"><button class="help" data-help-key="ts">?</button><span class="help-tooltip"></span></span>
        </p>
        <h1 id="hero-title">FTP 업로드 성능 · 좌석/파일별 분석</h1>
        <p class="lede" id="hero-lede">
          금요일 실습 때 학생들이 FTP로 올린 파일이 어느 좌석에서 높은 처리량을 냈는지, 어떤 파일이 서버 자원을 많이 먹었는지 한눈에 보여주는 관제형 대시보드입니다.
          서버에서 실행하며, 업로드 시점의 처리량·지연·오류율을 실시간으로 수집합니다.
        </p>
        <div class="hero__actions">
          <button class="pill active" data-level="low">Warm-up</button>
          <button class="pill" data-level="normal">정상 업로드</button>
          <button class="pill" data-level="peak">Peak 업로드</button>
          <button class="pill pill--alert" data-level="overload">과부하 테스트</button>
        </div>
        <p class="note" id="hero-note">
          IIS/Node.js 위에 FTP 로그·업로드 이벤트를 붙여서 실시간으로 처리량, 파일 크기, 좌석별 IP를 기록합니다.
          <span class="help-wrap"><button class="help" data-help-key="webserver">?</button><span class="help-tooltip"></span></span>
        </p>
      </div>
      <div class="hero__panel">
        <div class="status-chip" id="stage-chip">현재 단계: Low</div>
        <div class="highlight">
          <h3 id="highlight-title">
            금요일 업로드 모니터
            <span class="help-wrap"><button class="help" data-help-key="scalability">?</button><span class="help-tooltip"></span></span>
          </h3>
          <p class="highlight__value" id="rps-highlight">-- req/s</p>
          <p class="sub" id="highlight-sub">RPS · 응답 시간 · 오류율을 실시간으로 폴링합니다.</p>
          <div class="mini-grid">
            <div>
              <p class="label">
                CPU
                <span class="help-wrap"><button class="help" data-help-key="cpu">?</button><span class="help-tooltip"></span></span>
              </p>
              <p class="metric" id="cpu-highlight">--%</p>
            </div>
            <div>
              <p class="label">
                메모리
                <span class="help-wrap"><button class="help" data-help-key="memory">?</button><span class="help-tooltip"></span></span>
              </p>
              <p class="metric" id="memory-highlight">-- MB</p>
            </div>
          </div>
        </div>
      </div>
    </header>

    <main class="content" id="dashboard">
      <section class="warning" id="warning" hidden>Peak 단계 경고: 응답 지연/오류 발생</section>

      <section class="panel panel--spec" id="spec">
        <div>
          <h3 id="spec-title">FTP 업로드 · 실시간 계측</h3>
          <p class="sub" id="spec-sub">업로드 순간의 CPU·메모리·디스크 IO를 즉시 읽어 좌석/IP 로그와 함께 저장합니다.</p>
          <ul class="spec-list">
            <li id="spec-ram">RAM 실시간 사용/여유 표시.</li>
            <li id="spec-disk">디스크 IO(R/W MB/s) 실시간 표시.</li>
            <li id="spec-io">업로드 이벤트와 함께 서버 내부 계측값을 동기화.</li>
          </ul>
        </div>
        <div class="legend">
          <p class="legend__title" id="profile-title">라이브 업로드 상태</p>
          <ul class="profile-list">
            <li id="profile-cpu">CPU: --</li>
            <li id="profile-mem">메모리: --</li>
            <li id="profile-rps">실시간 RPS: --</li>
            <li id="profile-latency">평균 지연: --</li>
            <li id="profile-error">오류율: --</li>
          </ul>
          <p class="profile-note" id="profile-note"></p>
        </div>
      </section>

      <section class="grid">
        <article class="card">
          <p class="label">
            업로드 처리량
            <span class="help-wrap"><button class="help" data-help-key="rps">?</button><span class="help-tooltip"></span></span>
          </p>
          <p class="value" id="card-rps">-- req/s</p>
        </article>
        <article class="card">
          <p class="label">
            업로드 지연
            <span class="help-wrap"><button class="help" data-help-key="latency">?</button><span class="help-tooltip"></span></span>
          </p>
          <p class="value" id="card-latency">-- ms</p>
        </article>
        <article class="card">
          <p class="label">
            CPU
            <span class="help-wrap"><button class="help" data-help-key="cpu">?</button><span class="help-tooltip"></span></span>
          </p>
          <p class="value" id="card-cpu">--%</p>
        </article>
        <article class="card">
          <p class="label">
            메모리
            <span class="help-wrap"><button class="help" data-help-key="memory">?</button><span class="help-tooltip"></span></span>
          </p>
          <p class="value" id="card-memory">-- MB</p>
        </article>
        <article class="card">
          <p class="label">
            오류율
            <span class="help-wrap"><button class="help" data-help-key="errorRate">?</button><span class="help-tooltip"></span></span>
          </p>
          <p class="value" id="card-error">--%</p>
        </article>
        <article class="card">
          <p class="label">활성 단계</p>
          <p class="value" id="card-stage">Low</p>
        </article>
      </section>

      <section class="panel" id="identity">
        <div>
          <h3 id="identity-title">업로드 태그 설정 (좌석/파일)</h3>
          <p class="sub" id="identity-sub">
            업로드를 보낸 좌석번호와 파일명(또는 패키지)을 태그로 남기면 리더보드와 분석 카드에 그대로 표시됩니다. 브라우저에만 임시 저장합니다.
            <span class="help-wrap"><button class="help" data-help-key="webclient">?</button><span class="help-tooltip"></span></span>
          </p>
          <form id="name-form" class="name-form">
            <input id="name-input" name="name" type="text" minlength="2" maxlength="32" placeholder="예: StudentA" />
            <input id="seat-input" name="seat" type="text" minlength="1" maxlength="32" placeholder="좌석/조" />
            <input id="file-input" name="file" type="text" minlength="2" maxlength="64" placeholder="업로드한 파일/패키지" />
            <button type="submit" class="pill" id="name-save-btn">저장</button>
            <span class="name-status" id="name-status"></span>
          </form>
        </div>
        <div class="legend">
          <p class="legend__title" id="identity-legend-title">기록 방식</p>
          <ul>
            <li id="identity-legend-1">업로드 시각·좌석/파일 태그를 함께 기록</li>
            <li id="identity-legend-2">CPU/메모리 실측값을 업로드 이벤트와 함께 저장</li>
            <li id="identity-legend-3">최고 처리량, 최저 지연, 오류율, 안정성 점수를 추적</li>
          </ul>
        </div>
      </section>

      <section class="panel panel--insights" id="insights">
        <div>
          <h3 id="insights-title">업로드 통계 스냅샷</h3>
          <p class="sub" id="insights-sub">금요일 업로드에서 가장 뜨거운 좌석과 파일, Peak 처리량을 바로 보여줍니다.</p>
        </div>
        <div class="insight-grid">
          <article class="insight-card">
            <p class="label" id="insight-top-tag-label">최고 처리량 좌석/태그</p>
            <p class="value" id="insight-top-tag">--</p>
            <p class="muted" id="insight-top-tag-meta">데이터 수집 중...</p>
          </article>
          <article class="insight-card">
            <p class="label" id="insight-top-file-label">가장 무거운 파일</p>
            <p class="value" id="insight-top-file">--</p>
            <p class="muted" id="insight-top-file-meta">업로드 로그 동기화 대기</p>
          </article>
          <article class="insight-card">
            <p class="label" id="insight-peak-label">최고 처리량 순간</p>
            <p class="value" id="insight-peak-rps">-- req/s</p>
            <p class="muted" id="insight-peak-meta">--</p>
          </article>
          <article class="insight-card">
            <p class="label" id="insight-seat-label">가장 바쁜 좌석</p>
            <p class="value" id="insight-seat">--</p>
            <p class="muted" id="insight-seat-meta">RPS/지연 기준</p>
          </article>
        </div>
      </section>

      <section class="charts">
        <div class="chart-card">
          <div class="chart-header">
            <div>
              <p class="label">업로드량 &amp; 지연</p>
              <h3>Upload Throughput vs Response</h3>
            </div>
            <p class="tag" id="tag-live">
              실시간
              <span class="help-wrap"><button class="help" data-help-key="dashboard">?</button><span class="help-tooltip"></span></span>
            </p>
          </div>
          <canvas id="rpsChart" height="130"></canvas>
        </div>
        <div class="chart-card">
          <div class="chart-header">
            <div>
              <p class="label">CPU &amp; 메모리</p>
              <h3>리소스 사용률</h3>
            </div>
            <p class="tag">
              Performance Monitor 대응
              <span class="help-wrap"><button class="help" data-help-key="perfmon">?</button><span class="help-tooltip"></span></span>
            </p>
          </div>
          <canvas id="resourceChart" height="130"></canvas>
        </div>
      </section>

      <section class="panel" id="steps">
        <div>
          <h3 id="steps-title">
            금요일 업로드 체크리스트
            <span class="help-wrap"><button class="help" data-help-key="loadtest">?</button><span class="help-tooltip"></span></span>
          </h3>
          <p class="sub" id="steps-sub">
            FTP 업로드와 함께 `load level`을 전환하면 `/api/load/:level`이 호출되고 `/api/metrics`가 갱신됩니다. 업로드 트래픽·파일을 기록할 때 활용하세요.
          </p>
          <ul class="steps">
            <li id="step-low">Warm-up: 베이스라인 RPS/지연 확보</li>
            <li id="step-normal">Normal: 평균 지연과 CPU 안정성 확인</li>
            <li id="step-peak">
              Peak: 업로드 폭주 시 경고 배너 확인
              <span class="help-wrap"><button class="help" data-help-key="peak">?</button><span class="help-tooltip"></span></span>
            </li>
            <li id="step-overload">Overload: 의도적 포화(오류율/지연 급증)</li>
          </ul>
        </div>
        <div class="legend">
            <p class="legend__title" id="monitor-title">
              모니터링 포인트 (FTP/HTTP)
              <span class="help-wrap"><button class="help" data-help-key="stability">?</button><span class="help-tooltip"></span></span>
            </p>
            <ul>
              <li id="monitor-1">
              업로드 로그: 좌석·파일명과 타임스탬프
              <span class="help-wrap"><button class="help" data-help-key="perfmon">?</button><span class="help-tooltip"></span></span>
            </li>
            <li id="monitor-2">
              시스템 계측: CPU/메모리/디스크 IO
              <span class="help-wrap"><button class="help" data-help-key="loadtest">?</button><span class="help-tooltip"></span></span>
            </li>
            <li id="monitor-3">
              Peak 알람: 지연·오류율 증가 시 경고 배너 확인
              <span class="help-wrap"><button class="help" data-help-key="taskmgr">?</button><span class="help-tooltip"></span></span>
            </li>
          </ul>
        </div>
      </section>

      <section class="panel leaderboard" id="leaderboard">
        <div class="leaderboard__head">
          <div>
            <p class="label" id="leaderboard-label">
              Leaderboard
              <span class="help-wrap"><button class="help" data-help-key="leaderboard">?</button><span class="help-tooltip"></span></span>
            </p>
            <h3 id="leaderboard-title">IP/파일별 업로드 순위</h3>
            <p class="sub" id="leaderboard-sub">IP·좌석·파일 태그별 최고 처리량, 지연, 오류율, 안정성 점수를 집계합니다.</p>
          </div>
          <div class="badge-set">
            <span class="badge">Peak Breaker</span>
            <span class="badge badge--alt">High Stability</span>
            <span class="badge badge--speed">Speed Master</span>
          </div>
        </div>
        <div class="table-wrap">
          <table>
            <thead>
              <tr>
                <th id="th-rank">Rank</th>
                <th id="th-user">좌석 / 파일</th>
                <th id="th-peak">Peak 처리량</th>
                <th id="th-latency">평균 지연</th>
                <th id="th-error">오류율</th>
                <th id="th-state">서버 상태</th>
                <th id="th-stability">안정성</th>
              </tr>
            </thead>
            <tbody id="leaderboard-body">
              <tr><td colspan="7" class="muted">데이터 수집 대기 중...</td></tr>
            </tbody>
          </table>
        </div>
      </section>
    </main>
    <footer class="footer">
      <div class="footer__links">
        <a href="https://github.com/GabrielJung0727/PeakLoadVisualizer" target="_blank" rel="noopener">GitHub</a>
        <a href="/docs.html" target="_blank" rel="noopener">Docs</a>
        <a href="/service.html" target="_blank" rel="noopener">CyberAttack Sim</a>
      </div>
      <p class="muted">Windows Server 2016 · Load Lab</p>
    </footer>
  </body>
</html>
